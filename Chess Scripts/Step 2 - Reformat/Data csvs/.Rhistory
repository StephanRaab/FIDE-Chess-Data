filter(!Activity %in% Active)%>%
group_by(Date)%>%
summarise(total_count = n(),
avg_rating = mean(Rating, na.rm = T),
sd_rating = sd(Rating, na.rm = T))
All_players <- FIDE%>%
group_by(Date)%>%
summarise(total_count = n(),
avg_rating = mean(Rating, na.rm = T),
sd_rating = sd(Rating, na.rm = T))%>%
mutate(gain_loss = c(NA, diff(total_count)))
All_countries <- FIDE%>%
filter(Activity %in% Active)%>%
group_by(Date, Country)%>%
summarise(total_count = n())
strongest <- FIDE%>%
filter(Date_numeric == max(Date_numeric),
Activity %in% Active,
as.numeric(Age_Birthday) > 1900,
as.numeric(Age_Birthday) < 2019,
Rating > 900,
Rating < 3000)%>%
transmute(Country, Age = 2020-as.numeric(Age_Birthday), Rating)
breaks <- seq(min(strongest$Age), max(strongest$Age), 3)
break_labels = paste(breaks[-length(breaks)], breaks[-1], sep = "-")
breaks <- seq(min(strongest$Age), max(strongest$Age), 5)
break_labels = paste(breaks[-length(breaks)], breaks[-1], sep = "-")
breaks <- seq(min(strongest$Age), max(strongest$Age), 10)
break_labels = paste(breaks[-length(breaks)], breaks[-1], sep = "-")
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
head()
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
group_by(Country, Age_groups)%>%
summarise(count = n())
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n())
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n())%>%
filter(count > 10)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),
average_rating = mean(Rating))%>%
filter(count > 10)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),
average_rating = mean(Rating)%>%round())%>%
filter(count > 10)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),
average_rating = mean(Rating)%>%round())%>%
filter(count > 10)%>%
arrange(Age_groups, -average_rating)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),
average_rating = mean(Rating)%>%round())%>%
filter(count > 50)%>%
arrange(Age_groups, -average_rating)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),
average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),
average_rating = mean(Rating)%>%round())%>%
filter(count > 100, Age_groups != "86-96")%>%
arrange(Age_groups, -average_rating)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),average_rating = mean(Rating)%>%round())%>%
filter(count > 100, Age_groups != "86-96")%>%
arrange(Age_groups, -average_rating)%>%
group_by(Age_groups, -average_rating)%>%
top_n(n = 10)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),average_rating = mean(Rating)%>%round())%>%
filter(count > 100, Age_groups != "86-96")%>%
arrange(Age_groups, -average_rating)%>%
group_by(Age_groups, average_rating)%>%
top_n(n = 10)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),average_rating = mean(Rating)%>%round())%>%
filter(count > 100, Age_groups != "86-96")%>%
arrange(Age_groups, -average_rating)%>%
group_by(Age_groups)%>%
top_n(n = 10)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),average_rating = mean(Rating)%>%round())%>%
filter(count > 100, Age_groups != "86-96")%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 10)
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(),average_rating = mean(Rating)%>%round())%>%
filter(count > 100, Age_groups != "86-96")%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 10)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups)+
theme_bw()+
theme(axis.text=element_text(size=6))
breaks <- seq(min(strongest$Age), max(strongest$Age), 6)
break_labels = paste(breaks[-length(breaks)], breaks[-1], sep = "-")
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 10)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 8)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups)+
theme_bw()+
theme(axis.text=element_text(size=6))
breaks <- seq(min(strongest$Age), max(strongest$Age), 4)
break_labels = paste(breaks[-length(breaks)], breaks[-1], sep = "-")
breaks <- seq(min(strongest$Age), max(strongest$Age), 15)
break_labels = paste(breaks[-length(breaks)], breaks[-1], sep = "-")
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 8)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 8)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups, ncol = 2)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 7)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups, ncol = 2)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 7)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups, ncol = 1)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 7)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
facet_wrap(~Age_groups, ncol = 2)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 100)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 7)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
ggtitle("Highest rated age groups by country")+
facet_wrap(~Age_groups, ncol = 2)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 200)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 7)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
ggtitle("Highest rated age groups by country")+
facet_wrap(~Age_groups, ncol = 2)+
theme_bw()+
theme(axis.text=element_text(size=6))
strongest%>%
mutate(Age_groups = cut(Age,
breaks=breaks,
include.lowest=TRUE,
right=FALSE,
labels=break_labels))%>%
filter(!is.na(Age_groups))%>%
group_by(Country, Age_groups)%>%
summarise(count = n(), average_rating = mean(Rating)%>%round())%>%
filter(count > 200)%>%
arrange(Age_groups, -average_rating)%>%
select(-count)%>%
group_by(Age_groups)%>%
top_n(n = 7)%>%
ggplot(aes(x= Country, y= average_rating))+
geom_bar(stat ="identity")+
coord_flip()+
xlab("Country")+
ylab("Average Ratng")+
ggtitle("Highest rated age groups by country")+
facet_wrap(~Age_groups, ncol = 2)+
theme_bw()+
theme(axis.text=element_text(size=7))
setwd("~/GitHub/FIDE/Chess Scripts/Step 1 - Download/Downloaded files")
setwd("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat")
setwd("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat")
setwd("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Data csvs")
setwd("~/GitHub/FIDE/Chess Scripts/Step 1 - Download/Downloaded files")
"~/GitHub/FIDE/Chess Scripts/Step 1 - Download/Downloaded files"
setwd("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Data csvs")
"~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Data csvs"
setwd("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat")
unlink(list.files(pattern = "*.csv"))
library(knitr)
library(dplyr)
library(data.table)
library(Kmisc)
library(stringi)
library(foreach)
library(doParallel)
load("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Reformat_cache/latex/unnamed-chunk-10_681df1de033328d54851519a2ab7232c.RData")
setwd("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Data csvs")
path = "~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Data csvs"
knitr::opts_knit$set(root.dir = path)
temp = list.files(path = path,
pattern = "\\.csv?")
head(temp)
num <- function(x) match(tolower(x), tolower(month.abb))
month <- function(x){return(substr(x, 1, 3))}
add_zero <- function(x){if (x <= 9){x = paste("0", x, sep = "")}; return(x)}
temp%>%
sapply(month)%>%
sapply(num)%>%
sapply(add_zero)%>%
paste("20", substr(temp, 4, 5), "-", ., "-", "01", sep = "")-> month_num
head(month_num)
proper_temp <- paste(path, temp, sep = "")
n = length(month_num)
dataset_random = sample.int(length(month_num), n)
for(i in 1:length(proper_temp)) {
assign(month_num[i], fread(proper_temp[i], sep = ",", data.table = FALSE,
strip.white = TRUE, blank.lines.skip = TRUE))
}
library(tidyverse)
library(data.table)
library(xts)
library(dygraphs)
library(foreach)
library(doParallel)
library(zoo)
library(stringi)
library(cowplot)
library(gganimate)
library(lubridate)
path = "~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Data csvs/"
knitr::opts_knit$set(root.dir = path)
temp = list.files(path = path,
pattern = "\\.csv?")
head(temp)
num <- function(x) match(tolower(x), tolower(month.abb))
month <- function(x){return(substr(x, 1, 3))}
add_zero <- function(x){if (x <= 9){x = paste("0", x, sep = "")}; return(x)}
temp%>%
sapply(month)%>%
sapply(num)%>%
sapply(add_zero)%>%
paste("20", substr(temp, 4, 5), "-", ., "-", "01", sep = "")-> month_num
head(month_num)
proper_temp <- paste(path, temp, sep = "")
n = length(month_num)
dataset_random = sample.int(length(month_num), n)
for(i in 1:length(proper_temp)) {
assign(month_num[i], fread(proper_temp[i], sep = ",", data.table = FALSE,
strip.white = TRUE, blank.lines.skip = TRUE))
}
setwd("~/GitHub/FIDE/Chess Scripts/Step 2 - Reformat/Data csvs")
unlink(list.files(path = destination, pattern = "*.csv"))
unlink(list.files(pattern = "*.csv"))
